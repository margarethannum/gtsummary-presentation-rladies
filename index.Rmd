---
title: "gtsummary"
subtitle: "Creating publication-ready analytical tables"
author: "Margie Hannum <br/><br/>Memorial Sloan Kettering Cancer Center<br/><br/>"
date: "February 26, 2020"
output:
  xaringan::moon_reader:
    css: [ninjutsu, default, metropolis, metropolis-fonts, "my-theme.css"]
    lib_dir: libs
    nature:
      ratio: 16:9
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: true
---

```{r setup, include=FALSE}
# xaringan::inf_mr()
options(htmltools.dir.version = FALSE)
knitr::opts_chunk$set(echo = TRUE, eval = TRUE)
library(tidyverse)
library(rlang)
library(knitr)
library(gtsummary)
library(gt)
set.seed(78987)

theme_set(mskRvis::theme_biostat())

```


class: center
background-image: url(images/gtsummary_logo.png)
background-size: contain



# {gtsummary} package




???

-Create reproducible summary and analytic tables that are ready to present. Create demographic tables, summarize regression models, and report analysis results. 

-Other packages out there to create similar tables are opinionated without being very customizable

-What if a collaborator wants 2 decimal places? 3? Mean (Range) for some variables and Median (IQR) for others? Bolding significant p-values? 
A special kind of confidence interval formula instead of the default?

- Often end up doing formatting after-the-fact which is not reproducible! Or, people have their own siloed code to make tables a particular way that they like (also not reproducible and shareable, unless they also make a package)


---

# {gtsummary} Overview

.large[
* Package will create your tabular summaries, with sensible defaults that are highly customizable
  - Summarize data frames/tibbles
  - Summarize regression models
  - Customize tables
  - Report statistics from {gtsummary} tables inline in R Markdown
]

---
# {gtsummary} v1.2.5 - Package Website

.large[
* Package Website: http://www.danieldsjoberg.com/gtsummary/

  * <img src = "images/open-book-white.png" width="2.4%" height="2.4%"> Installation instructions
  
  * <img src = "images/open-book-white.png" width="2.4%" height="2.4%"> Thorough documentation on every function
  
  * <img src = "images/open-book-white.png" width="2.4%" height="2.4%"> Detailed tutorials 
  
* Install {gtsummary} with the following code: 
]

``` {r, eval=FALSE}
install.packages("gtsummary")          
```

.large[
* Also recommended to install the development version of {gt} from GitHub.
]
``` {r, eval=FALSE}
install.packages("remotes")
remotes::install_github("rstudio/gt")        
```



???
- visit the website and give quick tour
---

# {gt} - an aside

.large[
.pull-left[
* New package from RStudio

* Package for printing highly customized tables

* Goal is to unify code for creating tables in HTML, Word (via RTF), and PDF

* Check it out! https://gt.rstudio.com/
]
.pull-right[
<img src="images/gt_logo.png" width=90%>
]
]

???
-Gauge room for who uses kable/gt

-When Dan started developing gtsummary last year it was originally designed for our tables to be printed using knitr::kable(). But mid-last-year Rich Iannone from RStudio started developing a table construction package called {gt}, and even though it’s still in development (and not on CRAN), since it’s from the RStudio world we anticipate it will have full support and eventually be widely adopted, so he switched our package to take full advantage of the functionality {gt} offers. Still can use our package and print with kable, more on that later.

---
# {gt} - an aside
.pull-left[
* "We can construct a wide variety of useful tables with a cohesive set of table parts. These include the *table header*, the *stub*, the *stub head*, the *column labels*, the *table body*, and the *table footer*."

* Workflow: input dataframe or tibble, create gt object (list with data and formatting elements), output gt table as HTML (previewed in the Viewer). 

]
.pull-right[
<img src="images/gt_parts_of_a_table.png" width=110%>
]

Image source: https://gt.rstudio.com/

???
the gt documentation is great!

all functions grouped by the part of a table they modify

---
# {gtsummary} Print Engines - gt or kable?
.large[
.pull-left[
## gt

♥ Highly Customizable 

♥ All output includes informative footnotes

♥ HTML Output

♥ PDF Output

⚠ MS Word Output via RTF still in dev, requires re-sizing of tables by hand
]

.pull-right[
## kable

⚠ Less Customizable 

⚠ Footnotes and spanning headers stripped from all output

♥ HTML Output

♥ PDF Output

♥ MS Word Output
]

**We built {gtsummary} as a companion to {gt} and highly recommend it!** 

]
.footnote[All examples shown use {gt} print engine]

---
# **trial** dataset overview

.pull-left[

```{r}
head(trial, 3) #<<
```

<p align="center"><img src="images/gt_trial_info.png" width=60%>
]

.medium[
.pull-right[
* Throughout this presentation examples will use the `trial` dataset, included with {gtsummary}. 

* Dataset contains baseline characterstics of 200 patients who received Drug A or Drug B. Includes outcome of tumor response to the treatment. 

* Variables have label attributes assigned using the `labelled` package. 

* For simplicity in this presentation, subset data to a few variables of interest:
```{r, results = FALSE}
sm_trial <- trial %>% 
  select(trt, age, response, grade)
```
]
]


---
```{r child='02-tbl_summary.Rmd'}
```

---
```{r child='03-tbl_regression.Rmd'}
```

